<div class="container">
  <div class="left-panel">
    <h2>PDF Signer</h2>

    <div class="upload-section">
      <label class="label">Upload PDF:</label>
      <input type="file" (change)="onFileSelected($event)" accept="application/pdf" />
    </div>

    <div *ngIf="pdfSrc && totalPages > 1" class="page-selector">
      <label class="label">Select Page:</label>
      <select [(ngModel)]="sigPage" (change)="centerSignature()">
        <option *ngFor="let p of pageNumbers" [value]="p">{{ p }}</option>
      </select>
    </div>

    <hr class="divider" />

    <div *ngIf="pdfSrc" class="signature-section">
      <h3>Draw Signature</h3>
      <canvas #sigPad width="400" height="150" class="signature-canvas"></canvas>
      <div class="button-group">
        <button class="btn" (click)="clearSignature()">Clear Canvas</button>
        <button class="btn btn-primary" (click)="useCanvasSignature()">Use This Signature</button>
      </div>

      <h3>Or Upload Signature</h3>
      <input type="file" accept="image/*" (change)="onSignatureUpload($event)" />
    </div>

    <div *ngIf="pdfSrc" class="download-btn">
      <button class="btn btn-success" (click)="applySignature()">Apply & Download PDF</button>
    </div>
  </div>

  <div class="pdf-container" #pdfContainer *ngIf="pdfSrc" style="position: relative;">
    <pdf-viewer
      [src]="pdfSrc"
      [render-text]="true"
      [(page)]="sigPage"  [show-all]="true"
      style="display:block; width:100%; height:100%;"
      (after-load-complete)="onPdfLoad($event)">
    </pdf-viewer>
  
    <ng-container *ngIf="signatureDisplayUrl">
      <img [src]="signatureDisplayUrl"
            class="signature"
            [ngStyle]="{
              'position': 'absolute', 
              'left.px': sigPosX,      
              'top.px': sigPosY,     
              'width.px': sigWidth,
              'height.px': sigHeight
            }"
            (mousedown)="startDrag($event)"
            (touchstart)="startDrag($event)" />
  
      <div class="resize-handle"
            [ngStyle]="{
              'position': 'absolute',
              'left.px': sigPosX + sigWidth,
              'top.px': sigPosY + sigHeight
            }"
            (mousedown)="startResize($event)"
            (touchstart)="startResize($event)">
      </div>
    </ng-container>
  </div>
</div>