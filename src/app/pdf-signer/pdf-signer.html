<div class="container">
  <div class="left-panel">
    <h2>PDF Signer</h2>

    <div class="upload-section">
      <label class="label">Upload PDF:</label>
      <input type="file" (change)="onFileSelected($event)" accept="application/pdf" />
    </div>

    <div *ngIf="pdfSrc && totalPages > 1" class="page-selector">
      <label class="label">Select Page:</label>
      <select [(ngModel)]="sigPage" (change)="centerSignature()">
        <option *ngFor="let p of pageNumbers" [value]="p">{{ p }}</option>
      </select>
    </div>

    <hr class="divider" />

    <div *ngIf="pdfSrc" class="signature-section">
      <h3>Draw Signature</h3>
      <canvas #sigPad width="400" height="150" class="signature-canvas"></canvas>
      <div class="button-group">
        <button class="btn" (click)="clearSignature()">Clear Canvas</button>
        <button class="btn btn-primary" (click)="useCanvasSignature()">Use This Signature</button>
      </div>

      <h3>Or Upload Signature</h3>
      <input type="file" accept="image/*" (change)="onSignatureUpload($event)" />
    </div>

    <div *ngIf="pdfSrc" class="download-btn">
      <button class="btn btn-success" (click)="applySignature()">Apply & Download PDF</button>
    </div>
  </div>

  <div class="pdf-container" #pdfContainer *ngIf="pdfSrc" style="position: relative;">
    <pdf-viewer
      [src]="pdfSrc"
      [render-text]="true"
      [page]="sigPage"
      [show-all]="false"
      style="display:block; width:100%; height:100%;"
      (after-load-complete)="onPdfLoad($event)">
    </pdf-viewer>

    <ng-container *ngIf="signatureDisplayUrl">
      <div class="page-wrapper" [style.position]="'absolute'" [style.top.px]="0" [style.left.px]="0">
        <img [src]="signatureDisplayUrl"
             class="signature"
             [ngStyle]="{
               'left.px':sigPosX+10,
               'top.px':sigPosY+10,
               'width.px':sigWidth,
               'height.px':sigHeight
             }"
             (mousedown)="startDrag($event)"
             (touchstart)="startDrag($event)" />

        <div class="resize-handle"
             (mousedown)="startResize($event)"
             (touchstart)="startResize($event)"
             [ngStyle]="{
               'left.px':sigPosX + sigWidth - 12,
               'top.px':sigPosY + sigHeight - 12
             }">
        </div>
      </div>
    </ng-container>
  </div>
</div>